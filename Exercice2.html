<!DOCTYPE html>
<html lang="fr">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercice2 JSON</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
        integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">

</head>

<body>

<!--id--> 
    <select id="regions">
        <option value="regions">Regions</option>
    </select>

    <select id="departements">
        <option value="departements">Departements</option>
    </select>


<!--!!-->
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        rossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js"
        integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+"
        crossorigin="anonymous"></script>


<!--script-->
    <script>

        $(document).ready(function () {


//1
            var top = "ajax.json";
            $.getJSON(top, function (data) {

                var regions = data.regions;
                var departements = data.departements;
                var liste_select1 = $("#regions");

                liste_select1.empty();

                $.each(regions, function (element, reg) {
                    var resultat = `<option value="${reg.reg_id}">${reg.reg_v_nom}</option>`;
                    console.log(reg);
                    liste_select1.append(resultat);
                });
            });


//2

        $("#regions").change(function () {
        fun();
        });
        function fun() {

        var idd = $("#regions").val();
  console.log(idd) 
        $.getJSON(top, function (data) {
   
        var liste_select2 = $("#departements");
        liste_select2.empty(); 

        var index=data.departements.filter(function(departements){
        return departements.dep_reg_id==idd; 
        });
    //  console.log(index)

        $.each(index, function (element, departements) {
            var opt = `<option value="${departements.dep_reg_id}">${departements.dep_nom} </option>`;
     
        liste_select2.append(opt);
         });
       });
       };
     });
     </script> 
        




</body>

</html> 

